[tool.mypy]
strict = true
allow_redefinition = true
ignore_missing_imports = true

[tool.setuptools.packages.find]
include = ["cneuromax"]

[project]
name = "cneuromax"
requires-python = ">=3.10" # Did not test with lower versions
authors = [{ name = "The SIMEXP Laboratory", email = "simexp.lab@gmail.com" }]
description = "The Courtois Neuromod Project's centralized Machine Learning repository"
version = "0.0.1"
dependencies = [
    ### Packages required for cneuromax/fitting/
    "submitit==1.5.0",
    "hydra-core@git+https://github.com/courtois-neuromod/hydra@f89f83fc4095b3fa4fefd858b5fef00a296c3aec", # Hydra w/ updated Submitit
    "hydra-submitit-launcher@git+https://github.com/courtois-neuromod/hydra@f89f83fc4095b3fa4fefd858b5fef00a296c3aec#subdirectory=plugins/hydra_submitit_launcher/",
    "hydra-zen==0.11.0",
    "hydra-orion-sweeper==1.6.3",
    # Required for cneuromax/fitting/deeplearning/
    "torch==2.0.1",
    "lightning==2.1.0",
    "transformers==4.34.0",
    # Required for cneuromax/fitting/neuroevolution/
    "mpi4py==3.1.5",
    # Computer Vision packages
    "torchvision==0.15.2",
    "opencv-python==4.8.1.78",
    # Torch shapes
    "jaxtyping==0.2.22",
    "beartype==0.16.3",
    "einops==0.7.0",
    # Required for docs/
    "sphinx==7.2.6",
    "furo==2023.9.10",
    "sphinx-autobuild==2021.3.14",
    "sphinx-copybutton==0.5.2",
    "sphinx-autoapi==3.0.0",
    "esbonio==0.16.2",
    # Jupyter
    "jupyterlab==4.0.7",
    "jupyterlab-code-formatter==2.2.1",
    "ipywidgets==8.1.1",
    # Testing
    "black[jupyter]==23.9.1",
    "ruff==0.1.0",
    "doc8==1.1.1",
    "yamllint==1.32.0",
    "pre-commit==3.5.0",
    "mypy==1.6.1",
    "pytest==7.4.2",
    "pytest-cov==4.1.0",
    # W&B
    "wandb==0.15.12",
    "wandb-osh==1.1.2",
]

[tool.black]
line-length = 79

[tool.ruff]
line-length = 79
select = ["ALL"]
ignore = [
    "F722", # Syntax error in forward annotation: {body}.
            # https://beta.ruff.rs/docs/rules/forward-annotation-syntax-error/
            # Disabled to be able to utilize Jaxtyping, see:
            # https://docs.kidger.site/jaxtyping/faq/#flake8-or-ruff-are-throwing-an-error
    "G004", # Logging statement uses f-string.
            # https://beta.ruff.rs/docs/rules/#flake8-logging-format-g
            # Disabled to make it less verbose to log since printing is
            # disabled, see: https://beta.ruff.rs/docs/rules/print/
    "SLF001", # Private member accessed: {access}.
              # https://beta.ruff.rs/docs/rules/private-member-access/
              # Disabled to make use of certain private Lightning classes (ex:
              # Trainer checkpointing)

]

[tool.ruff.pycodestyle]
max-doc-length = 72

[tool.ruff.pydocstyle]
convention = "google"

[tool.ruff.per-file-ignores]
"*_test.py" = [
    "S101",  # Use of assert detected.
             # https://beta.ruff.rs/docs/rules/assert/
             # Disabled to be able to use assertions in test files.
    "PLR2004", # Magic value used in comparison, consider replacing {value}
               # with a constant variable.
               # https://beta.ruff.rs/docs/rules/magic-value-comparison/
               # Disabled to be able to use magic values in test files.
]

"conftest.py" = [
    "F401",  # {name} imported but unused; consider using importlib.util.find_spec to test for availability
             # https://beta.ruff.rs/docs/rules/unused-import/
             # Disabled to import fixtures.
]

[tool.doc8]
max-line-length = 79
